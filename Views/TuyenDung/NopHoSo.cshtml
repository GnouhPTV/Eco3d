<script src="~/Scripts/nicEdit.js" type="text/javascript"></script> 
<script type="text/javascript">
    var csrfToken = $('input[name="__RequestVerificationToken"]').val();
    $(document).ready(function () {
        new nicEditor().panelInstance('txtSoThich');
        new nicEditor().panelInstance('txtKyNang');
        new nicEditor().panelInstance('txtKinhNghiem');
        $(".popup .popup-close").click(function () {
            var bPopup = $(this).parent().bPopup();
            bPopup.close();
        });
    });
    // function UpLoadDoc() {
    //     var data = new FormData();
    //     var GroupFolder = $("#txtTen").val();
    //     if (GroupFolder == "") {
    //         MessageBoxWarning("Bạn phải điền họ tên trước.");
    //         $("#fileUploadDoc").val("");
    //         return;
    //     }
    //     data.append("tempPath", "~/Images/UngVien/");
    //     data.append("GroupFolder", GroupFolder);
    //     var files = $("#fileUploadDoc").get(0).files;
    //     if (files.length > 0) {
    //         data.append("UpLoadFileAttach", files[0]);
    //     } else {
    //         MessageBoxWarning("Bạn chưa đính kèm tài liệu.");
    //         return;
    //     }

    //     var ajaxRequest = $.ajax({
    //         type: "POST",
    //         url: "/WebService/FileUploadAttack.ashx",
    //         contentType: false,
    //         processData: false,
    //         data: data
    //     });

    //     ajaxRequest.done(function (data) {
    //         if (data != "") {
    //             console.log(data);
    //             $("#txtUrlDoc").val(data);
    //             $("#link-document").attr("href", data);
    //             $("#link-document").show();
    //             $("#link-document span").html("Tệp tin đã upload");

    //         } else {
    //             MessageBoxWarning("Không tải đc tài liệu");
    //             $('.loadding-doc').html('');
    //         }
    //     });
    // }
    // // Show ảnh đại diện
    // function UpLoadImage() {
    //     var data = new FormData();
    //     var GroupFolder = $("#txtTen").val();
    //     if (GroupFolder == "") {
    //         MessageBoxWarning("Bạn phải điền họ tên trước.");
    //         $("#fileUploadImage").val('');
    //         return;
    //     }
    //     data.append("tempPath", "~/Images/UngVien/");
    //     data.append("GroupFolder", GroupFolder);
    //     var files = $("#fileUploadImage").get(0).files;
    //     if (files.length > 0) {
    //         data.append("UpLoadFileAttach", files[0]);
    //     } else {
    //         MessageBoxWarning("Bạn chưa đính kèm tài liệu.");
    //         return;
    //     }

    //     var ajaxRequest = $.ajax({
    //         type: "POST",
    //         url: "/WebService/FileUploadAttack.ashx",
    //         contentType: false,
    //         processData: false,
    //         data: data
    //     });

    //     ajaxRequest.done(function (data) {
    //         if (data != "") {
    //             console.log(data);
    //             // Reload
    //             var num = Math.random();
    //             var imgSrc = data;
    //             $('#txtHinhAnh').val(data);
    //             setTimeout(function () {
    //                 $('#main-img').attr('src', imgSrc + '?v=' + num.toString());
    //             }, 2000);
    //             MessageBoxSuccess("Đăng ảnh thành công.");
    //         } else {
    //             MessageBoxWarning("Không tải đc tài liệu");
    //             $('.loadding-doc').html('');
    //         }
    //     });
    // }


    // function showImage(input) {
    //     var d = new Date();
    //     var tenanh = d.getTime().toString();
    //     var fullPath = document.getElementById('fProduct').value;
    //     if (fullPath) {
    //         var startIndex = (fullPath.indexOf('\\') >= 0 ? fullPath.lastIndexOf('\\') : fullPath.lastIndexOf('/'));
    //         var filename = fullPath.substring(startIndex);
    //         if (filename.indexOf('\\') === 0 || filename.indexOf('/') === 0) {
    //             filename = filename.substring(1);
    //         }
    //         console.log(filename);
    //         var url = '~/Images/UngVien/' + filename;
    //         $("#txtHinhAnh").val('/Images/UngVien/' + filename);
    //         UpLoadImageProduct('fProduct', url, 600, 600);
    //     }

    // }
    // function UpLoadImageProduct(id, url, width, height) {
    //     var fileUpload = $("[id='" + id + "']").get(0);
    //     var files = fileUpload.files;
    //     var data = new FormData();
    //     for (var i = 0; i < files.length; i++) {
    //         data.append(files[i].name, files[i]);
    //     }
    //     data.append("url", url);
    //     data.append("width", width);
    //     data.append("height", height);
    //     $.ajax({
    //         url: "/WebService/FileUpload.ashx",
    //         type: "POST",
    //         data: data,
    //         contentType: false,
    //         processData: false,
    //         beforeSend: function () {
    //             $('#main-img').attr('src', '/Images/loading2.gif');
    //         },
    //         success: function (result) {
    //             if (result == "1") {
    //                 // Reload
    //                 var num = Math.random();
    //                 var imgSrc = $("#txtHinhAnh").val();

    //                 setTimeout(function () {
    //                     $('#main-img').attr('src', imgSrc + '?v=' + num.toString());
    //                 }, 2000);
    //                 MessageBoxSuccess("Đăng ảnh thành công.");

    //             } else {
    //                 MessageBoxWarning("Vui lòng chọn lại ảnh.");
    //                 $("txtHinhAnh").val("");
    //             }
    //         }
    //     });
    // }


    function PlaceH(input) {
        $(input).on('focus', function () {
            setTimeout(function () {
                $(this).attr('placeholder', '');
            }, 2000);

        });
    }


    //'&#039;'
    function EncodeHtml(content) {
        if (typeof (content) == 'undefined') return content;
        content = content.toString().replace(/'/g, '~');
        content = content.toString().replace(/"/g, '&quot;');
        return content;

    }
    function SaveUngVien() {
        var valid = $("#formRecruitment").form('validate');
        if (valid == false) return;
        var HoTen = EncodeHtml($('#txtTen').val());
        var DiaChi = $('#txtAddress').val();
        var DienThoai = $('#txtTel').val();
        var Email = $("#txtEmailUV").val();
        var ChucVu = $('#tenViTri').val();
        var NgaySinh = $('#txtBirthday').val();
        var GioiTinh = $('#drGioiTinh').val();
        var HocVan = $('#drTrinhDo').val();
        // var kynang = JSON.stringify(EncodeHtml(nicEditors.findEditor('txtKyNang').getContent()));
        var LinkCV = $('#txtUrlDoc').val();
        //Model
        var requestData = {
           HoTen: HoTen, DiaChi: DiaChi, DienThoai: DienThoai, Email: Email, ChucVu: ChucVu,
            NgaySinh: NgaySinh, GioiTinh: GioiTinh, HocVan: HocVan, LinkCV: LinkCV
        };
        console.log(JSON.stringify(requestData));
        $.ajax({
            type: "POST",
            contentType: "application/json; charset=utf-8",
            url: "/TuyenDung/SendEmailNopHoSo",
            data: JSON.stringify(requestData),
            dataType: "json",
            beforeSend: function () {
                $('#formTVLoading').html('<img src="/Images/loading2.gif" />');
            },
            success: function (response) {
                var check = response.d;
                if (check != "0") {
                    ShowMessage("Hồ sơ của bạn đã gửi thành công.\n Xin vui lòng kiểm tra lại email đăng ký.");
                    var bPopup = $("#formRecruitment").bPopup();
                    bPopup.close();
                }
                else {
                    ShowMessageW("Cập nhật không thành công.");
                }
            },
            headers: {
                RequestVerificationToken: csrfToken
            },
            complete: function () {
                $('.page-loading').hide();
            }
        });

    }


    function NopHoSo(idVitri, tenViTri) {
        $('#formRecruitment').bPopup({
            modalClose: true,
            opacity: 0.6,
            transition: 'slideDown'
        });
        $("#idVitri").val(idVitri);
        $("#tenViTri").val(tenViTri);
        console.log(tenViTri);
        $("#tenViTriFormTD").html(tenViTri);
    }

    function NewRecruitment() {


        $('#txtHinhAnh').val('');
    }

    function OnCloseRecruitment() {
        var bPopup = $('#formRecruitment').bPopup();
        bPopup.close();
        $('#alerttxtMa').remove();
    }

    function xmlToString(xmlData) {
        var xmlString;
        //IE
        if (window.ActiveXObject) {
            xmlString = xmlData.xml;
        }
        else {
            xmlString = (new XMLSerializer()).serializeToString(xmlData);
        }
        return xmlString;
    }



</script>
<div id="formRecruitment" class="popup popup-bg adminform">
    <input type="hidden" name="tenViTri" id="tenViTri" />
    <a href="javascript:void(0);" class="popup-close" onclick="OnCloseRecruitment();" title="close"></a>
    <div class="div_button">
        <h4 class="title"><span id="tenViTriFormTD"></span></h4>
        <img id="save_loading" src="/Images/loading2.gif" alt="Đang gửi mail" style="display: none" />
        <a id="btnSendRec" href="javascript:void(0);"
           class="btn" onclick="SaveUngVien();"><i class="fal fa-envelope"></i> Gửi hồ sơ</a>
    </div>
    <div id="tabs" class="" style="width: 100%; height: auto" data-options="tabHeight:25,tabPosition:'left'">
        <div id="tabs-1" title="Thông tin">
            <div class="pt-15 pb-15">
                <div class="row row-16">
                    <div class="col-sm-6  form-group col-left d-flex">
                        <div class="input-group">
                            <input type="text" class="form-control  easyui-validatebox" id="txtTen"
                                   placeholder="Họ và tên"
                                   data-options="prompt:'Nhập tên sản phẩm.',required:true,tipPosition:'top'" />

                        </div>
                    </div>
                    <div class="col-sm-6  form-group col-right">
                        <div class="input-group datewrap">
                            <input type="text" runat="server" class="easyui-datebox"
                                   id="txtBirthday" value="21/07/2001"
                                   placeholder="Ngày sinh"
                                   data-options="prompt:'Chọn ngày.',tipPosition:'top',validType:'date'" clientidmode="Static" name="txtBirthday" />

                        </div>
                    </div>
                </div>
                <div class="row row-16">
                    <div class="col-sm-6  form-group col-left d-flex">
                        <div class="input-group">
                            <input type="text" class="form-control  easyui-validatebox" id="txtAddress"
                                   placeholder="Địa chỉ"
                                   data-options="prompt:'Nhập địa chỉ.',required:true,tipPosition:'top'" />
                        </div>
                    </div>
                    <div class="col-sm-6  form-group col-right">
                        <div class="input-group">
                            <select id="drGioiTinh" class="form-control form-control-sm" style="width: 150px">
                                <option value="Nam">Nam</option>
                                <option value="Nữ">Nữ</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="row row-16">
                    <div class="col-sm-6  form-group col-left d-flex">
                        <div class="input-group">
                            <input type="text" class="form-control input-r1 easyui-validatebox" id="txtTel"
                                   placeholder="Điện thoại"
                                   data-options="prompt:'Nhập số điện thoại.',tipPosition:'top',validType:'phone',required:true" />
                        </div>
                    </div>
                    <div class="col-sm-6  form-group col-right">
                        <div class="input-group">
                            <select id="drTrinhDo" class="form-control form-control-sm" style="width: 150px">
                                <option value="Trung cấp">Trung cấp</option>
                                <option value="Cao đẳng">Cao đẳng</option>
                                <option value="Đại học">Đại học</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="row row-16">
                    <div class="col-sm-6  form-group col-left d-flex">
                        <div class="input-group">
                            <input id="txtEmailUV" type="text" class="form-control input-r1 easyui-validatebox"
                                   placeholder="Email"
                                   data-options="prompt:'Nhập địa chỉ Email.',tipPosition:'top',validType:'email',required:true" />
                        </div>
                    </div>

                    <div class="col-sm-6  form-group col-right">
                        <div class="input-group">
                            <input id="txtUrlDoc" type="text" class="form-control input-r1 easyui-validatebox" style="width: 150px"
                                   placeholder="Nhập link CV"
                                   data-options="prompt:'Nhập link CV',tipPosition:'top',validType:'email',required:true" />
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>
    <div class="clear-fix"></div>
    <div id="tabs-2" title="Sở thích" class="hide">

        <div class="w-100" style="line-height: normal; background: #fff;">
            <textarea id="txtSoThich" class="easyui-validatebox" cols="10" rows="4" style="height: 300px; width: 707px"></textarea>
        </div>

    </div>
    <div id="tab-3" title="Kỹ năng" class="hide">
        <div class="w-100" style="line-height: normal; background: #fff;">
            <textarea id="txtKyNang" class="easyui-validatebox" cols="10" rows="4" style="height: 300px; width: 707px"></textarea>
        </div>
    </div>
    <div id="tab-4" title="Kinh nghiệm" class="">
        <div class="w-100" style="line-height: normal; background: #fff;">
            <textarea id="txtKinhNghiem" class="easyui-validatebox"
                      cols="10" rows="4" style="height: 150px; width: 570px"></textarea>
        </div>
    </div>
</div>
<div class="div_form_hide">
</div>

